-- Decompiled with the Synapse X Luau decompiler.

local l__rbxts_include__1 = game:GetService("ReplicatedStorage"):FindFirstChild("rbxts_include");
local v2 = l__rbxts_include__1 and require(l__rbxts_include__1.RuntimeLib);
if v2 then
	local v3 = v2.Promise;
else
	v3 = require(script.Parent.Parent.Parent.Promise);
end;
local u1 = require(script.Parent.Parent.util);
local u2 = require(script.Parent.Parent.Controller);
return function(p1, p2, p3, p4)
	local v4 = p1.useValue(nil);
	local v5 = p1.useValue({});
	local v6 = p1.useValue({});
	if typeof(p3) == "table" then
		local v7 = true;
		if v4.value ~= nil then
			v7 = v4.value == false;
		end;
		assert(v7, "useSprings detected a change from imperative to declarative. This is not supported.");
		v4.value = false;
	elseif typeof(p3) == "function" then
		local v8 = true;
		if v4.value ~= nil then
			v8 = v4.value == true;
		end;
		assert(v8, "useSprings detected a change from declarative to imperative. This is not supported.");
		v4.value = true;
	else
		error("Expected table or function for useSprings, got " .. typeof(p3));
	end;
	local u3 = p1.useValue({});
	p1.useEffect(function()
		if v4.value == false then
			for v9, v10 in ipairs(u3.value) do
				local v11 = {};
				if p3[v9].reset then
					local v12 = p3[v9].reset;
				else
					v12 = false;
				end;
				v11.reset = v12;
				v10:start(u1.merge({
					default = true
				}, (u1.merge(p3[v9], v11))));
			end;
		end;
	end, p4);
	p1.useMemo(function()
		if not (#u3.value < p2) then
			for v13 = p2 + 1, #u3.value do
				u3.value[v13]:stop();
				u3.value[v13] = nil;
				v5.value[v13] = nil;
				v6.value[v13] = nil;
			end;
			return;
		end;
		for v14 = #u3.value + 1, p2 do
			if typeof(p3) == "table" then
				local v15 = p3[v14];
			else
				v15 = p3(v14);
			end;
			local v16, v17 = u2.new(v15);
			u3.value[v14] = v17;
			v5.value[v14] = v16;
		end;
	end, { p2 });
	p1.useMemo(function()
		if v4.value and #u3.value > 0 then
			for v18, v19 in pairs(getmetatable(u3.value[1])) do
				if typeof(v19) == "function" and v18 ~= "new" then
					v6.value[v18] = function(p5)
						local v20 = {};
						for v21, v22 in ipairs(u3.value) do
							table.insert(v20, v3.new(function(p6)
								if typeof(p5) == "function" then
									local v23 = p5(v21);
								else
									v23 = p5;
								end;
								local v24 = v22[v18](v22, v23);
								if v24 and v24.await then
									v24:await();
								end;
								p6();
							end));
						end;
						return v3.all(v20);
					end;
				end;
			end;
		end;
	end, p4 or { {} });
	p1.useEffect(function()
		return function()
			for v25, v26 in ipairs(u3.value) do
				v26:stop();
			end;
		end;
	end, {});
	if not v4.value then
		return v5.value;
	end;
	return v5.value, v6.value;
end;
