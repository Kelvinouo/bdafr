-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, script.Parent.Parent, "event-template");
local l__EventTemplate__3 = v2.EventTemplate;
local v4 = v1.import(script, script.Parent.Parent, "sync-event-priority");
local v5 = setmetatable({}, {
	__tostring = function()
		return "ParameterizedSyncEvent";
	end, 
	__index = l__EventTemplate__3
});
v5.__index = v5;
function v5.new(...)
	local v6 = setmetatable({}, v5);
	return v6:constructor(...) and v6;
end;
function v5.constructor(p1, ...)
	l__EventTemplate__3.constructor(p1, ...);
	p1.entries = {};
	p1.listenedParameters = {};
end;
local l__SyncEventPriority__1 = v4.SyncEventPriority;
local l__HttpService__2 = v1.import(script, v1.getModule(script, "@rbxts", "services")).HttpService;
local l__MapUtil__3 = v1.import(script, v1.getModule(script, "@easy-games", "data-structure").out).MapUtil;
local l__EventConnection__4 = v2.EventConnection;
function v5.connect(p2, p3, p4, p5, p6)
	if p5 == nil then
		p5 = l__SyncEventPriority__1.NORMAL;
	end;
	if p6 == nil then
		p6 = 0;
	end;
	local v7 = l__HttpService__2:GenerateGUID(false);
	local v8 = p4;
	if v8 == nil then
		v8 = {};
	end;
	local v9 = p2:encodeParameters(v8, true);
	local v10 = l__MapUtil__3.getOrCreate(p2.entries, v9, {});
	v10[v7] = {
		priority = p5, 
		callbackInfo = {
			callback = p3, 
			callingThreadInfo = p2:getCallingThreadInfo(p6)
		}
	};
	return l__EventConnection__4.new(function()
		v10[v7] = nil;
		local v11 = 0;
		for v12 in pairs(v10) do
			v11 = v11 + 1;
		end;
		if v11 == 0 then
			p2.entries[v9] = nil;
		end;
	end);
end;
local l__SyncEventPriorityOrdered__5 = v4.SyncEventPriorityOrdered;
function v5.fire(p7, ...)
	local v13 = p7:constructEvent({ ... });
	local v14 = {};
	local v15, v16, v17 = ipairs(l__MapUtil__3.values(p7.listenedParameters));
	while true do
		v15(v16, v17);
		if not v15 then
			break;
		end;
		v17 = v15;
		local v18 = p7.entries[p7:encodeParameters(p7:reduceParameters(v13:getParameters(), v16), false)];
		if v18 then
			local v19, v20, v21 = ipairs(l__MapUtil__3.values(v18));
			while true do
				v19(v20, v21);
				if not v19 then
					break;
				end;
				v21 = v19;
				table.insert(l__MapUtil__3.getOrCreate(v14, v20.priority, {}), v20);			
			end;
		end;	
	end;
	local v22, v23, v24 = ipairs(l__SyncEventPriorityOrdered__5);
	while true do
		v22(v23, v24);
		if not v22 then
			break;
		end;
		local v25, v26, v27 = ipairs(v14[v23] or {});
		while true do
			v25(v26, v27);
			if not v25 then
				break;
			end;
			v27 = v25;
			p7:wrapCallback(v26.callbackInfo.callingThreadInfo, function()
				v26.callbackInfo.callback(v13);
			end);		
		end;	
	end;
	return v13;
end;
function v5.reduceParameters(p8, p9, p10)
	local v28 = {};
	local v29, v30, v31 = ipairs(p10);
	while true do
		v29(v30, v31);
		if not v29 then
			break;
		end;
		v31 = v29;
		v28[v30] = p9[v30];	
	end;
	return v28;
end;
local u6 = v1.import(script, v1.getModule(script, "@rbxts", "object-utils"));
function v5.quickInspect(p11, p12)
	local v32 = {};
	local v33, v34, v35 = ipairs(u6.keys(p12));
	while true do
		v33(v34, v35);
		if not v33 then
			break;
		end;
		v35 = v33;
		table.insert(v32, v34);
		table.insert(v32, "::");
		table.insert(v32, (tostring(p12[v34])));	
	end;
	return table.concat(v32, "");
end;
function v5.encodeParameters(p13, p14, p15)
	local v36 = u6.keys(p14);
	table.sort(v36);
	if p15 then
		p13.listenedParameters[p13:quickInspect(v36)] = v36;
	end;
	local v37 = {};
	local v38, v39, v40 = ipairs(v36);
	while true do
		v38(v39, v40);
		if not v38 then
			break;
		end;
		v40 = v38;
		table.insert(v37, v39);
		table.insert(v37, p14[v39]);	
	end;
	return p13:quickInspect(v37);
end;
local u7 = nil;
function v5.setParameters(p16, p17)
	return u7.new(p16):setParameters(p17);
end;
function v5.setPriority(p18, p19)
	return u7.new(p18):setPriority(p19);
end;
u7 = setmetatable({}, {
	__tostring = function()
		return "ParameterizedSyncEventBuilder";
	end
});
u7.__index = u7;
function u7.new(...)
	local v41 = setmetatable({}, u7);
	return v41:constructor(...) and v41;
end;
function u7.constructor(p20, p21)
	p20.eventObject = p21;
end;
function u7.setParameters(p22, p23)
	p22.parameters = p23;
	return p22;
end;
function u7.setPriority(p24, p25)
	p24.priority = p25;
	return p24;
end;
function u7.connect(p26, p27)
	return p26.eventObject:connect(p27, p26.parameters, p26.priority, 1);
end;
function u7.fire(p28, ...)
	return p28.eventObject:fire(unpack({ ... }));
end;
return {
	ParameterizedSyncEvent = v5
};
