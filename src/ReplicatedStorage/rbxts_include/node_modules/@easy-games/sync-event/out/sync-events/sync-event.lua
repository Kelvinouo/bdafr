-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, script.Parent.Parent, "event-template");
local v3 = v1.import(script, script.Parent.Parent, "sync-event-priority");
local l__EventTemplate__4 = v2.EventTemplate;
local v5 = setmetatable({}, {
	__tostring = function()
		return "SyncEvent";
	end, 
	__index = l__EventTemplate__4
});
v5.__index = v5;
function v5.new(...)
	local v6 = setmetatable({}, v5);
	return v6:constructor(...) and v6;
end;
local u1 = l__EventTemplate__4;
function v5.constructor(p1, ...)
	u1.constructor(p1, ...);
	p1.entries = {};
end;
local l__SyncEventPriority__2 = v3.SyncEventPriority;
local l__HttpService__3 = v1.import(script, v1.getModule(script, "@rbxts", "services")).HttpService;
local l__EventConnection__4 = v2.EventConnection;
function v5.connect(p2, p3, p4, p5)
	if p4 == nil then
		p4 = l__SyncEventPriority__2.NORMAL;
	end;
	if p5 == nil then
		p5 = 0;
	end;
	local v7 = l__HttpService__3:GenerateGUID(false);
	p2:insertSyncEventEntry({
		id = v7, 
		priority = p4, 
		callbackInfo = {
			callback = p3, 
			callingThreadInfo = p2:getCallingThreadInfo(p5)
		}
	});
	return l__EventConnection__4.new(function()
		p2.entries[v7] = nil;
	end);
end;
local l__MapUtil__5 = v1.import(script, v1.getModule(script, "@easy-games", "data-structure").out).MapUtil;
local l__SyncEventPriorityOrdered__6 = v3.SyncEventPriorityOrdered;
function v5.fire(p6, ...)
	local v8 = p6:constructEvent({ ... });
	local v9 = l__MapUtil__5.values(p6.entries);
	local v10, v11, v12 = ipairs(l__SyncEventPriorityOrdered__6);
	while true do
		local v13, v14 = v10(v11, v12);
		if not v13 then
			break;
		end;
		local function v15(p7)
			return p7.priority == v14;
		end;
		local v16 = {};
		local v17 = 0;
		for v18, v19 in ipairs(v9) do
			if v15(v19, v18 - 1, v9) == true then
				v17 = v17 + 1;
				v16[v17] = v19;
			end;
		end;
		for v20, v21 in ipairs(v16) do
			p6:wrapCallback(v21.callbackInfo.callingThreadInfo, function()
				v21.callbackInfo.callback(v8);
			end);
		end;	
	end;
	return v8;
end;
function v5.insertSyncEventEntry(p8, p9)
	p8.entries[p9.id] = p9;
end;
local u7 = nil;
function v5.setPriority(p10, p11)
	return u7.new(p10):setPriority(p11);
end;
u1 = setmetatable;
u1 = u1({}, {
	__tostring = function()
		return "SyncEventBuilder";
	end
});
u7 = u1;
u7.__index = u7;
u1 = function(...)
	local v22 = setmetatable({}, u7);
	return v22:constructor(...) and v22;
end;
u7.new = u1;
u1 = function(p12, p13)
	p12.eventObject = p13;
end;
u7.constructor = u1;
u1 = function(p14, p15)
	p14.priority = p15;
	return p14;
end;
u7.setPriority = u1;
u1 = function(p16, p17)
	return p16.eventObject:connect(p17, p16.priority, 1);
end;
u7.connect = u1;
u1 = function(p18, ...)
	return p18.eventObject:fire(unpack({ ... }));
end;
u7.fire = u1;
u1 = {
	SyncEvent = v5
};
return l__EventTemplate__4;
