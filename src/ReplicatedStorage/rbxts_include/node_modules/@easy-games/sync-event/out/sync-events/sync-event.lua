-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, script.Parent.Parent, "event-template");
local l__EventTemplate__3 = v2.EventTemplate;
local v4 = v1.import(script, script.Parent.Parent, "sync-event-priority");
local v5 = setmetatable({}, {
	__tostring = function()
		return "SyncEvent";
	end, 
	__index = l__EventTemplate__3
});
v5.__index = v5;
function v5.new(...)
	local v6 = setmetatable({}, v5);
	return v6:constructor(...) and v6;
end;
function v5.constructor(p1, ...)
	l__EventTemplate__3.constructor(p1, ...);
	p1.entries = {};
end;
local l__SyncEventPriority__1 = v4.SyncEventPriority;
local l__HttpService__2 = v1.import(script, v1.getModule(script, "@rbxts", "services")).HttpService;
local l__EventConnection__3 = v2.EventConnection;
function v5.connect(p2, p3, p4, p5)
	if p4 == nil then
		p4 = l__SyncEventPriority__1.NORMAL;
	end;
	if p5 == nil then
		p5 = 0;
	end;
	local v7 = l__HttpService__2:GenerateGUID(false);
	p2:insertSyncEventEntry({
		id = v7, 
		priority = p4, 
		callbackInfo = {
			callback = p3, 
			callingThreadInfo = p2:getCallingThreadInfo(p5)
		}
	});
	return l__EventConnection__3.new(function()
		p2.entries[v7] = nil;
	end);
end;
local l__MapUtil__4 = v1.import(script, v1.getModule(script, "@easy-games", "data-structure").out).MapUtil;
local l__SyncEventPriorityOrdered__5 = v4.SyncEventPriorityOrdered;
function v5.fire(p6, ...)
	local v8 = p6:constructEvent({ ... });
	local v9 = l__MapUtil__4.values(p6.entries);
	local v10, v11, v12 = ipairs(l__SyncEventPriorityOrdered__5);
	while true do
		v10(v11, v12);
		if not v10 then
			break;
		end;
		local v13 = {};
		local v14 = 0;
		local v15, v16, v17 = ipairs(v9);
		while true do
			v15(v16, v17);
			if not v15 then
				break;
			end;
			if v16.priority == v11 == true then
				v14 = v14 + 1;
				v13[v14] = v16;
			end;		
		end;
		local v18, v19, v20 = ipairs(v13);
		while true do
			v18(v19, v20);
			if not v18 then
				break;
			end;
			v20 = v18;
			p6:wrapCallback(v19.callbackInfo.callingThreadInfo, function()
				v19.callbackInfo.callback(v8);
			end);		
		end;	
	end;
	return v8;
end;
function v5.insertSyncEventEntry(p7, p8)
	p7.entries[p8.id] = p8;
end;
local u6 = nil;
function v5.setPriority(p9, p10)
	return u6.new(p9):setPriority(p10);
end;
u6 = setmetatable({}, {
	__tostring = function()
		return "SyncEventBuilder";
	end
});
u6.__index = u6;
function u6.new(...)
	local v21 = setmetatable({}, u6);
	return v21:constructor(...) and v21;
end;
function u6.constructor(p11, p12)
	p11.eventObject = p12;
end;
function u6.setPriority(p13, p14)
	p13.priority = p14;
	return p13;
end;
function u6.connect(p15, p16)
	return p15.eventObject:connect(p16, p15.priority, 1);
end;
function u6.fire(p17, ...)
	return p17.eventObject:fire(unpack({ ... }));
end;
return {
	SyncEvent = v5
};
