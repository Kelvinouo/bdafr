-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, script.Parent.Parent, "event-template");
local v3 = v1.import(script, script.Parent.Parent, "sync-event-priority");
local l__EventTemplate__4 = v2.EventTemplate;
local v5 = setmetatable({}, {
	__tostring = function()
		return "SyncEvent";
	end, 
	__index = l__EventTemplate__4
});
v5.__index = v5;
function v5.new(...)
	local v6 = setmetatable({}, v5);
	return v6:constructor(...) and v6;
end;
local u1 = l__EventTemplate__4;
function v5.constructor(p1, ...)
	u1.constructor(p1, ...);
	p1.entries = {};
end;
local l__SyncEventPriority__2 = v3.SyncEventPriority;
local l__HttpService__3 = v1.import(script, v1.getModule(script, "@rbxts", "services")).HttpService;
local l__EventConnection__4 = v2.EventConnection;
function v5.connect(p2, p3, p4, p5)
	if p4 == nil then
		p4 = l__SyncEventPriority__2.NORMAL;
	end;
	if p5 == nil then
		p5 = 0;
	end;
	local v7 = l__HttpService__3:GenerateGUID(false);
	p2:insertSyncEventEntry({
		id = v7, 
		priority = p4, 
		callbackInfo = {
			callback = p3, 
			callingThreadInfo = p2:getCallingThreadInfo(p5)
		}
	});
	return l__EventConnection__4.new(function()
		p2.entries[v7] = nil;
	end);
end;
local l__MapUtil__5 = v1.import(script, v1.getModule(script, "@easy-games", "data-structure").out).MapUtil;
local l__SyncEventPriorityOrdered__6 = v3.SyncEventPriorityOrdered;
function v5.fire(p6, ...)
	local v8 = p6:constructEvent({ ... });
	local v9 = l__MapUtil__5.values(p6.entries);
	local v10, v11, v12 = ipairs(l__SyncEventPriorityOrdered__6);
	while true do
		local v13, v14 = v10(v11, v12);
		if not v13 then
			break;
		end;
		local v15 = {};
		local v16 = 0;
		local v17, v18, v19 = ipairs(v9);
		while true do
			local v20, v21 = v17(v18, v19);
			if not v20 then
				break;
			end;
			if v21.priority == v14 == true then
				v16 = v16 + 1;
				v15[v16] = v21;
			end;		
		end;
		for v22, v23 in ipairs(v15) do
			p6:wrapCallback(v23.callbackInfo.callingThreadInfo, function()
				v23.callbackInfo.callback(v8);
			end);
		end;	
	end;
	return v8;
end;
function v5.insertSyncEventEntry(p7, p8)
	p7.entries[p8.id] = p8;
end;
local u7 = nil;
function v5.setPriority(p9, p10)
	return u7.new(p9):setPriority(p10);
end;
u1 = setmetatable;
u1 = u1({}, {
	__tostring = function()
		return "SyncEventBuilder";
	end
});
u7 = u1;
u7.__index = u7;
u1 = function(...)
	local v24 = setmetatable({}, u7);
	return v24:constructor(...) and v24;
end;
u7.new = u1;
u1 = function(p11, p12)
	p11.eventObject = p12;
end;
u7.constructor = u1;
u1 = function(p13, p14)
	p13.priority = p14;
	return p13;
end;
u7.setPriority = u1;
u1 = function(p15, p16)
	return p15.eventObject:connect(p16, p15.priority, 1);
end;
u7.connect = u1;
u1 = function(p17, ...)
	return p17.eventObject:fire(unpack({ ... }));
end;
u7.fire = u1;
u1 = {
	SyncEvent = v5
};
return l__EventTemplate__4;
