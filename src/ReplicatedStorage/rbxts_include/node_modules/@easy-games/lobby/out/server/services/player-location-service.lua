-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, v1.getModule(script, "@flamework", "core").out);
local l__Reflect__3 = v2.Reflect;
local v4 = v1.import(script, v1.getModule(script, "@flamework", "core").out);
local v5 = setmetatable({}, {
	__tostring = function()
		return "PlayerLocationService";
	end
});
v5.__index = v5;
function v5.new(...)
	local v6 = setmetatable({}, v5);
	return v6:constructor(...) and v6;
end;
local u1 = v1.import(script, v1.getModule(script, "@rbxts", "mock-memory-store-service").lib);
function v5.constructor(p1, p2)
	p1.gameTeleportService = p2;
	p1.playerMap = u1:GetSortedMap("PlayerLocations");
end;
function v5.onStart(p3)

end;
local l__default__2 = v1.import(script, v1.getModule(script, "@rbxts", "log").out).default;
local l__Players__3 = v1.import(script, v1.getModule(script, "@rbxts", "services")).Players;
v5.registerPlayer = v1.async(function(p4, p5, p6, p7)
	l__default__2.Info("Registering player {@Player} in match", p5);
	local v7 = {
		placeId = p6, 
		accessCode = p7
	};
	p4.playerMap:SetAsync(tostring(p5.UserId), v7, 10800);
	local u4 = nil;
	u4 = l__Players__3.PlayerRemoving:Connect(function(p8)
		if p8 == p5 then
			local l__UserId__8 = p8.UserId;
			local v9 = p4.playerMap:GetAsync(tostring(l__UserId__8));
			if v9 and v9[1] == v7 then
				p4.playerMap:RemoveAsync(tostring(l__UserId__8));
			end;
			u4:Disconnect();
		end;
	end);
end);
local l__Flamework__5 = v2.Flamework;
local u6 = v1.import(script, v1.getModule(script, "@rbxts", "make"));
v5.teleportToMatch = v1.async(function(p9, p10, p11)
	l__default__2.Info("Attempting to teleport {@Player} to match of {Target}", p10, p11);
	local v10 = p9.playerMap:GetAsync(tostring(p11));
	if not v10 then
		return l__Flamework__5.resolveDependency("@easy-games/game-core:server/services/notification-service@NotificationService"):sendErrorNotification({ p10 }, {
			message = "This user isn't in a game!"
		});
	end;
	l__default__2.Info("Found server details for player {Player}, access code: {AccessCode}", p11, v10.accessCode);
	l__Flamework__5.resolveDependency("@easy-games/game-core:server/services/notification-service@NotificationService"):sendInfoNotification({ p10 }, {
		message = "Teleporting to server..."
	});
	local v11 = u6("TeleportOptions", {
		ReservedServerAccessCode = v10.accessCode
	});
	v11:SetTeleportData({
		isMod = true
	});
	v1.await(p9.gameTeleportService:teleportRetry(v10.placeId, { p10 }, v11));
end);
l__Reflect__3.defineMetadata(v5, "identifier", "@easy-games/lobby:server/services/player-location-service@PlayerLocationService");
l__Reflect__3.defineMetadata(v5, "flamework:parameters", { "@easy-games/lobby:server/services/game-teleport-service@GameTeleportService" });
l__Reflect__3.defineMetadata(v5, "flamework:implements", { "$:flamework@OnStart" });
l__Reflect__3.decorate(v5, "$:flamework@Service", v4.Service, { {} });
l__Reflect__3.decorate(v5, "$:flamework@External", v4.External, {});
return {
	PlayerLocationService = v5
};
