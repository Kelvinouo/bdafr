-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local l__Reflect__2 = v1.import(script, v1.getModule(script, "@flamework", "core").out).Reflect;
local v3 = v1.import(script, v1.getModule(script, "@flamework", "core").out);
local v4 = setmetatable({}, {
	__tostring = function()
		return "DeviceInfoEventHandlerService";
	end
});
v4.__index = v4;
function v4.new(...)
	local v5 = setmetatable({}, v4);
	return v5:constructor(...) and v5;
end;
function v4.constructor(p1, p2)
	p1.playerDataService = p2;
end;
function v4.onInit(p3)
	p3:connectEvents();
end;
local l__LobbyServerEvents__1 = v1.import(script, script.Parent.Parent.Parent, "events", "events").LobbyServerEvents;
local l__LocalizationService__2 = v1.import(script, v1.getModule(script, "@rbxts", "services")).LocalizationService;
function v4.connectEvents(p4)
	l__LobbyServerEvents__1.replicateClientData:connect(function(p5, p6)
		if p4.playerDataService:getDeviceInfo(p5.UserId) then
			return nil;
		end;
		local u3 = nil;
		v1.try(function()
			u3 = l__LocalizationService__2:GetCountryRegionForPlayerAsync(p5);
		end, function(p7)
			warn("Failed to get country code for player. Error:", p7);
			u3 = "US";
		end);
		p6.locale = u3;
		local u4 = "en-us";
		v1.try(function()
			u4 = l__LocalizationService__2:GetTranslatorForPlayerAsync(p5).LocaleId;
		end, function(p8)
			warn("Failed to get translator locale for player. Error:", p8);
		end);
		p6.translationLocale = u4;
		local v6 = p4.playerDataService:convertCountryToServerRegion(u3);
		print("[DataReplication] Player " .. tostring(p5) .. " server region is " .. v6);
		p6.region = v6;
		p4.playerDataService:setDeviceInfo(p5.UserId, p6);
		l__LobbyServerEvents__1.deviceInfoUpdate:fire(p5, {
			deviceInfo = p6
		});
	end);
end;
l__Reflect__2.defineMetadata(v4, "identifier", "@easy-games/lobby:server/services/event-handlers/device-info-event-handler-service@DeviceInfoEventHandlerService");
l__Reflect__2.defineMetadata(v4, "flamework:parameters", { "@easy-games/lobby:server/services/device-info-service@DeviceInfoService" });
l__Reflect__2.defineMetadata(v4, "flamework:implements", { "$:flamework@OnInit" });
l__Reflect__2.decorate(v4, "$:flamework@Service", v3.Service, { {} });
l__Reflect__2.decorate(v4, "$:flamework@External", v3.External, {});
return {
	DeviceInfoEventHandlerService = v4
};
