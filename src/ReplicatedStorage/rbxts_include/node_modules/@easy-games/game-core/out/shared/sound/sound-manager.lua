--[[VARIABLE DEFINITION ANOMALY DETECTED, DECOMPILATION OUTPUT POTENTIALLY INCORRECT]]--
-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, v1.getModule(script, "@rbxts", "services"));
local v3 = setmetatable({}, {
	__tostring = function()
		return "SoundManager";
	end
});
v3.__index = v3;
function v3.new(...)
	local v4 = setmetatable({}, v3);
	return v4:constructor(...) and v4;
end;
function v3.constructor(p1)

end;
function v3.registerSound(p2, p3, p4)
	if p4 == nil then
		p4 = {};
	end;
	local v5 = p4;
	if v5 ~= nil then
		v5 = v5.preload;
	end;
	local v6 = v5;
	if v6 == nil then
		v6 = true;
	end;
	p2.soundConfigs[p3] = p4;
	if v6 then
		table.insert(p2.preloadEntries, {
			assetId = p3, 
			config = p4
		});
	end;
end;
function v3.bulkRegisterSounds(p5, p6)
	local v7, v8, v9 = ipairs(p6);
	while true do
		v7(v8, v9);
		if not v7 then
			break;
		end;
		v9 = v7;
		if p5.soundConfigs[v8] == nil then
			p5:registerSound(v8);
		end;	
	end;
end;
local u1 = v1.import(script, v1.getModule(script, "@rbxts", "make"));
function v3.createSound(p7, p8)
	local v10 = p7.soundConfigs[p8] or {};
	local v11 = nil;
	if v10.playbackSpeed then
		v11 = v10.playbackSpeed.Min + math.random() * (v10.playbackSpeed.Max - v10.playbackSpeed.Min);
	end;
	local v12 = {
		Name = tostring(p8), 
		SoundId = p8
	};
	local v13 = v10.volume;
	if v13 == nil then
		v13 = 0.5;
	end;
	v12.Volume = v13;
	v12.PlaybackSpeed = v11;
	local v14 = v10.rollOffMaxDistance;
	if v14 == 0 or v14 ~= v14 or not v14 then
		v14 = 60;
	end;
	v12.RollOffMaxDistance = v14;
	v12.RollOffMinDistance = v10.rollOffMinDistance;
	return u1("Sound", v12);
end;
local u2 = v1.import(script, v1.getModule(script, "@rbxts", "object-utils"));
local l__ContentProvider__3 = v2.ContentProvider;
function v3.preload(p9)
	local v15 = {};
	local v16 = 0;
	local v17, v18, v19 = ipairs((u2.values(p9.preloadEntries)));
	while true do
		v17(v18, v19);
		if not v17 then
			break;
		end;
		if v18.config.preload ~= false == true then
			v16 = v16 + 1;
			v15[v16] = v18;
		end;	
	end;
	table.sort(v15, function(p10, p11)
		local v20 = p10.config.preloadPriority;
		if v20 == nil then
			v20 = 10;
		end;
		local v21 = p11.config.preloadPriority;
		if v21 == nil then
			v21 = 10;
		end;
		return v20 < v21;
	end);
	local v22 = {};
	local v23 = 0;
	local v24, v25, v26 = ipairs(v15);
	while true do
		v24(v25, v26);
		if not v24 then
			break;
		end;
		v26 = v24;
		local v27 = p9:createSound(v25.assetId);
		if v27 ~= nil then
			v23 = v23 + 1;
			v22[v23] = v27;
		end;	
	end;
	l__ContentProvider__3:PreloadAsync(v22);
end;
local l__GameQueryUtil__4 = v1.import(script, script.Parent.Parent, "game-world-query", "game-query-util").GameQueryUtil;
function v3.playSound(p12, p13, p14)
	if typeof(p13) == "Instance" then
		local v28 = p13;
	else
		local v29 = p12.soundConfigs[p13];
		if v29 then
			local v30 = {};
			for v31, v32 in pairs(v29) do
				v30[v31] = v32;
			end;
			if type(p14) == "table" then
				for v33, v34 in pairs(p14) do
					v30[v33] = v34;
				end;
			end;
			p14 = v30;
		end;
		v28 = p12:createSound(p13);
	end;
	if not v28 then
		return nil;
	end;
	local v35 = p14;
	if v35 ~= nil then
		v35 = v35.looped;
	end;
	if v35 ~= nil then
		v28.Looped = p14.looped;
	end;
	local v36 = p14;
	if v36 ~= nil then
		v36 = v36.volumeMultiplier;
	end;
	if v36 ~= nil then
		v28.Volume = v28.Volume * p14.volumeMultiplier;
	end;
	local v37 = p14;
	if v37 ~= nil then
		v37 = v37.playbackSpeedMultiplier;
	end;
	if v37 ~= nil then
		v28.PlaybackSpeed = v28.PlaybackSpeed * p14.playbackSpeedMultiplier;
	end;
	local v38 = p14;
	if v38 ~= nil then
		v38 = v38.rollOffMaxDistance;
	end;
	if v38 ~= nil then
		v28.RollOffMaxDistance = p14.rollOffMaxDistance;
	end;
	local v39 = p14;
	if v39 ~= nil then
		v39 = v39.rollOffMinDistsance;
	end;
	if v39 ~= nil then
		v28.RollOffMinDistance = p14.rollOffMinDistsance;
	end;
	local v40 = p14;
	if v40 ~= nil then
		v40 = v40.rollOffMode;
	end;
	if v40 ~= nil then
		v28.RollOffMode = p14.rollOffMode;
	else
		v28.RollOffMode = Enum.RollOffMode.InverseTapered;
	end;
	local v41 = p14;
	if v41 ~= nil then
		v41 = v41.fadeInTime;
	end;
	if v41 ~= 0 and v41 == v41 and v41 then
		v28.Volume = 0;
		p12:tweenSoundVolume(v28, v28.Volume, p14.fadeInTime);
	end;
	local v42 = p14;
	if v42 ~= nil then
		v42 = v42.fadeOutTime;
	end;
	if v42 ~= 0 and v42 == v42 and v42 then
		task.spawn(function()
			if not v28 then
				return nil;
			end;
			if not v28.IsLoaded then
				v28.Loaded:Wait();
			end;
			local l__TimeLength__43 = v28.TimeLength;
			while true do
				local v44 = task.wait(0.5);
				if v44 == 0 then
					break;
				end;
				if v44 ~= v44 then
					break;
				end;
				if not v44 then
					break;
				end;
				local v45 = v28;
				if v45 ~= nil then
					v45 = v45.IsPlaying;
				end;
				if not v45 then
					break;
				end;
				local v46 = (l__TimeLength__43 - v28.TimePosition) / v28.PlaybackSpeed;
				if v46 <= p14.fadeOutTime then
					p12:tweenSoundVolume(v28, 0, v46);
					return;
				end;			
			end;
		end);
	end;
	local v47 = p14;
	if v47 ~= nil then
		v47 = v47.position;
	end;
	local v48 = v47;
	if not v48 then
		local v49 = p14;
		if v49 ~= nil then
			v49 = v49.parent;
		end;
		v48 = v49;
	end;
	if v48 then
		local v50 = p14;
		if v50 ~= nil then
			v50 = v50.parent;
		end;
		local v51 = v50;
		local v52 = false;
		if not v51 and p14.position then
			v52 = true;
			local v53 = {
				Size = Vector3.new(1, 1, 1)
			};
			local v54 = p14;
			if v54 ~= nil then
				v54 = v54.position;
			end;
			v53.CFrame = CFrame.new(v54);
			v53.Anchored = true;
			v53.CanCollide = false;
			v53.CanQuery = false;
			v53.Transparency = 1;
			v53.Parent = p12.workspaceSoundsFolder;
			v51 = u1("Part", v53);
			l__GameQueryUtil__4:setQueryIgnored(v51);
		end;
		v28.Parent = v51;
		v28.Ended:Connect(function()
			local v55 = nil;
			wait(3);
			if v52 then
				v55 = v51;
				if v55 == nil then
					return;
				end;
			else
				if v28 ~= nil then
					v28:Destroy();
				end;
				return;
			end;
			v55:Destroy();
		end);
	else
		v28.Parent = p12.localSoundsFolder;
		v28.Ended:Connect(function()
			if v28 ~= nil then
				v28:Destroy();
			end;
		end);
	end;
	v28:Play();
	return v28;
end;
local l__TweenService__5 = v2.TweenService;
function v3.tweenSoundVolume(p15, p16, p17, p18, p19)
	local v56 = p19;
	if v56 ~= nil then
		v56 = v56.easingStyle;
	end;
	local v57 = v56;
	if v57 == nil then
		v57 = Enum.EasingStyle.Linear;
	end;
	local v58 = p19;
	if v58 ~= nil then
		v58 = v58.easingDirection;
	end;
	local v59 = v58;
	if v59 == nil then
		v59 = Enum.EasingDirection.In;
	end;
	local v60 = l__TweenService__5:Create(p16, TweenInfo.new(p18, v57, v59), {
		Volume = p17
	});
	v60:Play();
	return v60;
end;
v3.preloadEntries = {};
v3.soundConfigs = {};
v3.workspaceSoundsFolder = u1("Folder", {
	Name = "GameSounds", 
	Parent = v2.Workspace
});
v3.localSoundsFolder = u1("Folder", {
	Name = "GameSounds", 
	Parent = v2.Lighting
});
return {
	SoundManager = v3
};
