-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local l__Reflect__2 = v1.import(script, v1.getModule(script, "@flamework", "core").out).Reflect;
local l__Controller__3 = v1.import(script, v1.getModule(script, "@flamework", "core").out).Controller;
local v4 = v1.import(script, v1.getModule(script, "@rbxts", "services"));
local v5 = setmetatable({}, {
	__tostring = function()
		return "ProphuntGameReleaseController";
	end
});
v5.__index = v5;
function v5.new(...)
	local v6 = setmetatable({}, v5);
	return v6:constructor(...) and v6;
end;
function v5.constructor(p1, p2)
	p1.notificationController = p2;
	p1.placeId = 9611595239;
end;
local l__WatchCollectionTag__1 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "util", "collection-util").WatchCollectionTag;
local l__ProphuntGameRelease__2 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-release", "releases", "prophunt-game-release").ProphuntGameRelease;
local u3 = v1.import(script, v1.getModule(script, "@rbxts", "maid").Maid);
local l__GameCoreSharedSyncEvents__4 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-core-shared-events").GameCoreSharedSyncEvents;
local l__GameReleaseId__5 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-release", "game-release-id").GameReleaseId;
local l__TweenService__6 = v4.TweenService;
local u7 = v1.import(script, v1.getModule(script, "@rbxts", "make"));
local l__Workspace__8 = v4.Workspace;
local l__CollectionService__9 = v4.CollectionService;
local l__ContentProvider__10 = v4.ContentProvider;
function v5.onStart(p3)
	l__WatchCollectionTag__1(l__ProphuntGameRelease__2.COUNTDOWN_MODEL_TAG, function(p4)
		if not p3.gameRelease then
			return nil;
		end;
		local v7 = u3.new();
		if not p4.PrimaryPart then
			p4:GetPropertyChangedSignal("PrimaryPart"):Wait();
		end;
		v7:GiveTask(l__GameCoreSharedSyncEvents__4.GameReleaseShowContent:connect(function(p5)
			if p5.gameId ~= l__GameReleaseId__5.PROPHUNT then
				return nil;
			end;
			local v8 = Instance.new("CFrameValue");
			v8.Value = p4.PrimaryPart.CFrame;
			v8.Changed:Connect(function(p6)
				p4:SetPrimaryPartCFrame(p6);
			end);
			v8.Parent = p4;
			task.delay(1, function()
				local v9 = l__TweenService__6:Create(v8, TweenInfo.new(5, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
					Value = p4:GetPrimaryPartCFrame() + Vector3.new(0, -50, 0)
				});
				v9:Play();
				v9.Completed:Wait();
				p4:Destroy();
			end);
		end));
		p4.Destroying:Connect(function()
			v7:DoCleaning();
		end);
	end);
	l__WatchCollectionTag__1(l__ProphuntGameRelease__2.RELEASED_CONTENT_MODEL_TAG, function(p7)
		local v10 = p7:GetAttribute("GameReleaseFromCountdown");
		p3:hookPortal((p7:WaitForChild("Portal")));
		if not v10 then
			return nil;
		end;
		print("showing content from countdown!");
		task.delay(5.5, function()
			local v11 = Instance.new("CFrameValue");
			v11.Value = p7:GetPrimaryPartCFrame();
			v11.Parent = p7;
			v11.Changed:Connect(function(p8)
				p7:SetPrimaryPartCFrame(p8);
			end);
			l__TweenService__6:Create(v11, TweenInfo.new(5.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
				Value = p7:GetPrimaryPartCFrame() + Vector3.new(0, 50, 0)
			}):Play();
		end);
		u7("Sound", {
			Name = "GameReleasePortalRocks", 
			SoundId = "rbxassetid://6445706475", 
			RollOffMaxDistance = 300, 
			Volume = 0.38, 
			Parent = l__Workspace__8
		}):Play();
		local u11 = l__CollectionService__9:GetTagged("prophunt-rock-particles");
		task.spawn(function()
			for v12, v13 in ipairs(u11) do
				local v14 = 0;
				while v14 < 10 do
					local v15 = 0;
					local v16 = false;
					while true do
						if v16 then
							v15 = v15 + 1;
						else
							v16 = true;
						end;
						if not (v15 < 15) then
							break;
						end;
						if math.random() > 0.5 then
							local v17 = 1;
						else
							v17 = -1;
						end;
						if math.random() > 0.5 then
							local v18 = 1;
						else
							v18 = -1;
						end;
						if math.random() > 0.5 then
							local v19 = 1;
						else
							v19 = -1;
						end;
						p3:spawnPixelParticle(CFrame.new(v13.CFrame * Vector3.new(v17 * math.random() * (v13.Size.X / 2), v18 * math.random() * (v13.Size.Y / 2), v19 * math.random() * (v13.Size.Z / 2))), {
							particleBaseSize = 0.45, 
							color = Color3.fromHex("916d53")
						});					
					end;
					local v20 = 0.14 + math.random() * 0.08;
					v14 = v14 + v20;
					task.wait(v20);				
				end;
			end;
		end);
	end);
	task.spawn(function()
		l__ContentProvider__10:PreloadAsync({ (u7("Sound", {
				SoundId = "rbxassetid://6445706475"
			})) });
	end);
end;
local l__Players__12 = v4.Players;
local l__TeleportService__13 = v4.TeleportService;
function v5.hookPortal(p9, p10)
	local u14 = 0;
	p10.Touched:Connect(function(p11)
		local v21 = p11:FindFirstAncestorWhichIsA("Model");
		if not v21 then
			return nil;
		end;
		local v22 = l__Players__12:GetPlayerFromCharacter(v21);
		if not v22 or v22 ~= l__Players__12.LocalPlayer then
			return nil;
		end;
		if l__Workspace__8:GetServerTimeNow() - u14 < 2 then
			return nil;
		end;
		u14 = l__Workspace__8:GetServerTimeNow();
		l__TeleportService__13:Teleport(p9.placeId);
		p9.notificationController:sendInfoNotification({
			message = "Teleporting to Battle Royale!"
		});
	end);
end;
function v5.enableProphuntGameRelease(p12, p13, p14, p15)
	p12.gameRelease = l__ProphuntGameRelease__2.new(u7("Model", {}), p13, u7("Model", {}), p14, p15);
	task.spawn(function()
		l__ContentProvider__10:PreloadAsync({ u7("Sound", {
				SoundId = p15
			}) });
	end);
	return p12.gameRelease;
end;
local l__PhysicsService__15 = v4.PhysicsService;
local l__Debris__16 = v4.Debris;
function v5.spawnPixelParticle(p16, p17, p18)
	local v23 = 0;
	local v24 = false;
	while true do
		if v24 then
			v23 = v23 + 1;
		else
			v24 = true;
		end;
		local v25 = p18;
		if v25 ~= nil then
			v25 = v25.count;
		end;
		local v26 = v25;
		if v26 == nil then
			v26 = 1;
		end;
		if not (v23 < v26) then
			break;
		end;
		local v27 = Vector3.new(math.random(-100, 100) / 100 * 5, math.random(50, 100) / 100 * 16, math.random(-100, 100) / 100 * 5) * 0.75;
		local v28 = p18;
		if v28 ~= nil then
			v28 = v28.particleBaseSize;
		end;
		local v29 = v28;
		if v29 == nil then
			v29 = 0.18;
		end;
		local v30 = v29 * math.random(80, 150) / 100;
		local v31 = p18;
		if v31 ~= nil then
			v31 = v31.textureId;
		end;
		local v32 = v31;
		if v32 == nil then
			v32 = "rbxassetid://5274332913";
		end;
		local v33 = Instance.new("Part");
		v33.Size = Vector3.new(0.2, 0.2, 0.2);
		v33.CFrame = p17;
		v33.Velocity = v27;
		v33.Transparency = 1;
		v33.CanCollide = false;
		v1.Promise.defer(function()
			wait(0.05);
			v33.CanCollide = true;
		end);
		l__PhysicsService__15:SetPartCollisionGroup(v33, "Players");
		local v34 = Instance.new("BodyForce");
		v34.Force = Vector3.new(0, v33:GetMass() * l__Workspace__8.Gravity / 1.3, 0);
		v34.Parent = v33;
		local v35 = Instance.new("BillboardGui");
		v35.Size = UDim2.new(v30, 0, v30, 0);
		v35.LightInfluence = 0;
		local v36 = Instance.new("ImageLabel");
		local v37 = p18;
		if v37 ~= nil then
			v37 = v37.color;
		end;
		if v37 then
			v36.Image = "rbxassetid://5607858133";
			v36.ImageColor3 = v37;
		else
			v36.Image = v32;
			v36.ScaleType = Enum.ScaleType.Tile;
			v36.TileSize = UDim2.new(50, 0, 50, 0);
		end;
		local v38 = p18;
		if v38 ~= nil then
			v38 = v38.transparency;
		end;
		if v38 ~= nil then
			v36.Transparency = p18.transparency;
		end;
		v36.Size = UDim2.new(0, 0, 0, 0);
		v36.Position = UDim2.new(0.5, 0, 0.5, 0);
		v36.AnchorPoint = Vector2.new(0.5, 0.5);
		v36.BorderSizePixel = 0;
		v36.BackgroundTransparency = 1;
		v36.Parent = v35;
		l__TweenService__6:Create(v36, TweenInfo.new(0.1), {
			Size = UDim2.new(1, 0, 1, 0)
		}):Play();
		v35.Parent = v33;
		local v39 = Instance.new("BoolValue");
		v39.Name = "Targettable";
		v39.Value = false;
		v39.Parent = v33;
		v33.Parent = l__Workspace__8;
		v1.Promise.delay(0.78 + math.random() * 0.15):andThen(function()
			l__TweenService__6:Create(v36, TweenInfo.new(0.1), {
				Size = UDim2.new(0, 0, 0, 0)
			}):Play();
		end);
		l__Debris__16:AddItem(v33, 1);	
	end;
end;
l__Reflect__2.defineMetadata(v5, "identifier", "@easy-games/game-core:client/controllers/game-release/prophunt-game-release-controller@ProphuntGameReleaseController");
l__Reflect__2.defineMetadata(v5, "flamework:parameters", { "@easy-games/game-core:client/controllers/notification-controller@NotificationController" });
l__Reflect__2.defineMetadata(v5, "flamework:implements", { "$:flamework@OnStart" });
l__Reflect__2.decorate(v5, "$:flamework@Controller", l__Controller__3, { {} });
return {
	ProphuntGameReleaseController = v5
};
