-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = {
	constructor = function(p1, p2, p3, p4, p5)
		p1.id = p2;
		p1.name = p3;
		p1.generatorConfig = p4;
		p1.codeConfig = p5;
	end
};
local l__Players__1 = v1.import(script, v1.getModule(script, "@rbxts", "services")).Players;
local l__CodesUtil__2 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-codes", "game-codes-util").CodesUtil;
local l__Flamework__3 = v1.import(script, v1.getModule(script, "@flamework", "core").out).Flamework;
function v2.generateCodes(p6, p7)
	local v3 = {};
	if p7 ~= 0 and p7 == p7 and p7 then
		if not p6:hasPermission(p7) then
			return {
				success = false, 
				errorMessage = "\240\159\154\171 Error: You don't have permission to use this code generator"
			};
		end;
		local v4 = l__Players__1:GetPlayerByUserId(p7);
		if v4 and os.time() - p6.generatorConfig.regenCooldown < p6:getLastGenerateTime(v4) then
			return {
				success = false, 
				errorMessage = "\240\159\154\171 Error: Generating codes for this product is still on cooldown"
			};
		end;
	end;
	local v5 = 0;
	local v6 = false;
	while true do
		if v6 then
			v5 = v5 + 1;
		else
			v6 = true;
		end;
		if not (v5 < p6.generatorConfig.codesPerRegen) then
			break;
		end;
		local v7 = {
			code = l__CodesUtil__2.generateCode(12), 
			type = p6.id, 
			createdTime = os.time(), 
			creator = p7, 
			active = true, 
			timesRedeemed = 0, 
			codeRedeemLimits = p6.codeConfig
		};
		table.insert(v3, v7);
		local v8 = l__Flamework__3.resolveDependency("@easy-games/game-core:server/services/game-codes/game-codes-service@GameCodesService"):getCodeManager();
		if v8 ~= nil then
			v8:addGeneratedCodes({ v7 });
		end;	
	end;
	p6:onGenerateCodes(v3, p7);
	if p7 ~= 0 and p7 == p7 and p7 then
		p6:setLastGenerateTime(p7, os.time());
		l__Flamework__3.resolveDependency("@easy-games/game-core:server/services/game-codes/game-codes-service@GameCodesService"):sendCodeGenUpdate(p7);
	end;
	return {
		success = true, 
		data = {
			codes = v3
		}
	};
end;
return {
	GameCodeGenerator = v2
};
