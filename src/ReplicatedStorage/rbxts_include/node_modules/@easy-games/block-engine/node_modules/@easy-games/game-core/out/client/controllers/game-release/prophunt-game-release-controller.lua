-- Script Hash: f8b38cf0ed3ce582097e35625ea3512fad0e9f4a66d992242829dffe81ffdd9cda0ff91f707f767c0ffe5f0945e8cec9
-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local l__Reflect__2 = v1.import(script, v1.getModule(script, "@flamework", "core").out).Reflect;
local v3 = v1.import(script, v1.getModule(script, "@rbxts", "services"));
local v4 = setmetatable({}, {
	__tostring = function()
		return "ProphuntGameReleaseController";
	end
});
v4.__index = v4;
function v4.new(...)
	local v5 = setmetatable({}, v4);
	return v5:constructor(...) and v5;
end;
function v4.constructor(p1, p2)
	p1.notificationController = p2;
	p1.placeId = 8747402506;
end;
local l__WatchCollectionTag__1 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "util", "collection-util").WatchCollectionTag;
local l__ProphuntGameRelease__2 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-release", "releases", "prophunt-game-release").ProphuntGameRelease;
local u3 = v1.import(script, v1.getModule(script, "@rbxts", "maid").Maid);
local l__GameCoreSharedSyncEvents__4 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-core-shared-events").GameCoreSharedSyncEvents;
local l__GameReleaseId__5 = v1.import(script, script.Parent.Parent.Parent.Parent, "shared", "game-release", "game-release-id").GameReleaseId;
local l__TweenService__6 = v3.TweenService;
local l__CollectionService__7 = v3.CollectionService;
function v4.onStart(p3)
	l__WatchCollectionTag__1(l__ProphuntGameRelease__2.COUNTDOWN_MODEL_TAG, function(p4)
		if not p3.gameRelease then
			return nil;
		end;
		local v6 = u3.new();
		if not p4.PrimaryPart then
			p4:GetPropertyChangedSignal("PrimaryPart"):Wait();
		end;
		v6:GiveTask(l__GameCoreSharedSyncEvents__4.GameReleaseShowContent:connect(function(p5)
			if p5.gameId ~= l__GameReleaseId__5.PROPHUNT then
				return nil;
			end;
			local v7 = Instance.new("CFrameValue");
			v7.Value = p4.PrimaryPart.CFrame;
			v7.Changed:Connect(function(p6)
				p4:SetPrimaryPartCFrame(p6);
			end);
			v7.Parent = p4;
			task.delay(1, function()
				local v8 = l__TweenService__6:Create(v7, TweenInfo.new(5, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
					Value = p4:GetPrimaryPartCFrame() + Vector3.new(0, -100, 0)
				});
				v8:Play();
				v8.Completed:Wait();
				p4:Destroy();
			end);
		end));
		p4.Destroying:Connect(function()
			v6:DoCleaning();
		end);
	end);
	l__WatchCollectionTag__1(l__ProphuntGameRelease__2.RELEASED_CONTENT_MODEL_TAG, function(p7)
		local v9 = p7:GetAttribute("GameReleaseFromCountdown");
		p3:hookPortal((p7:WaitForChild("Portal")));
		if not v9 then
			return nil;
		end;
		print("showing content from countdown!");
		task.delay(5.5, function()
			local v10 = Instance.new("CFrameValue");
			v10.Value = p7:GetPrimaryPartCFrame();
			v10.Parent = p7;
			v10.Changed:Connect(function(p8)
				p7:SetPrimaryPartCFrame(p8);
			end);
			l__TweenService__6:Create(v10, TweenInfo.new(5.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
				Value = p7:GetPrimaryPartCFrame() + Vector3.new(0, 100, 0)
			}):Play();
		end);
		local u8 = l__CollectionService__7:GetTagged("prophunt-rock-particles");
		task.spawn(function()
			for v11, v12 in ipairs(u8) do
				local v13 = 0;
				while v13 < 10 do
					local v14 = 0;
					local v15 = false;
					while true do
						if v15 then
							v14 = v14 + 1;
						else
							v15 = true;
						end;
						if not (v14 < 15) then
							break;
						end;
						if math.random() > 0.5 then
							local v16 = 1;
						else
							v16 = -1;
						end;
						if math.random() > 0.5 then
							local v17 = 1;
						else
							v17 = -1;
						end;
						if math.random() > 0.5 then
							local v18 = 1;
						else
							v18 = -1;
						end;
						p3:spawnPixelParticle(CFrame.new(v12.CFrame * Vector3.new(v16 * math.random() * (v12.Size.X / 2), v17 * math.random() * (v12.Size.Y / 2), v18 * math.random() * (v12.Size.Z / 2))), {
							particleBaseSize = 0.45, 
							color = Color3.fromHex("916d53")
						});					
					end;
					local v19 = 0.14 + math.random() * 0.08;
					v13 = v13 + v19;
					task.wait(v19);				
				end;
			end;
		end);
	end);
end;
local l__Players__9 = v3.Players;
local l__Workspace__10 = v3.Workspace;
local l__TeleportService__11 = v3.TeleportService;
function v4.hookPortal(p9, p10)
	local u12 = 0;
	p10.Touched:Connect(function(p11)
		local v20 = p11:FindFirstAncestorWhichIsA("Model");
		if not v20 then
			return nil;
		end;
		local v21 = l__Players__9:GetPlayerFromCharacter(v20);
		if not v21 or v21 ~= l__Players__9.LocalPlayer then
			return nil;
		end;
		if l__Workspace__10:GetServerTimeNow() - u12 < 2 then
			return nil;
		end;
		u12 = l__Workspace__10:GetServerTimeNow();
		l__TeleportService__11:Teleport(p9.placeId);
		p9.notificationController:sendInfoNotification({
			message = "Teleporting to Prop Hunt!"
		});
	end);
end;
local u13 = v1.import(script, v1.getModule(script, "@rbxts", "make"));
local l__ContentProvider__14 = v3.ContentProvider;
function v4.enableProphuntGameRelease(p12, p13, p14, p15)
	p12.gameRelease = l__ProphuntGameRelease__2.new(u13("Model", {}), p13, u13("Model", {}), p14, p15);
	task.spawn(function()
		l__ContentProvider__14:PreloadAsync({ u13("Sound", {
				SoundId = p15
			}) });
	end);
	return p12.gameRelease;
end;
local l__PhysicsService__15 = v3.PhysicsService;
local l__Debris__16 = v3.Debris;
function v4.spawnPixelParticle(p16, p17, p18)
	local v22 = 0;
	local v23 = false;
	while true do
		if v23 then
			v22 = v22 + 1;
		else
			v23 = true;
		end;
		local v24 = p18;
		if v24 ~= nil then
			v24 = v24.count;
		end;
		local v25 = v24;
		if v25 == nil then
			v25 = 1;
		end;
		if not (v22 < v25) then
			break;
		end;
		local v26 = Vector3.new(math.random(-100, 100) / 100 * 5, math.random(50, 100) / 100 * 16, math.random(-100, 100) / 100 * 5) * 0.75;
		local v27 = p18;
		if v27 ~= nil then
			v27 = v27.particleBaseSize;
		end;
		local v28 = v27;
		if v28 == nil then
			v28 = 0.18;
		end;
		local v29 = v28 * math.random(80, 150) / 100;
		local v30 = p18;
		if v30 ~= nil then
			v30 = v30.textureId;
		end;
		local v31 = v30;
		if v31 == nil then
			v31 = "rbxassetid://5274332913";
		end;
		local v32 = Instance.new("Part");
		v32.Size = Vector3.new(0.2, 0.2, 0.2);
		v32.CFrame = p17;
		v32.Velocity = v26;
		v32.Transparency = 1;
		v32.CanCollide = false;
		v1.Promise.defer(function()
			wait(0.05);
			v32.CanCollide = true;
		end);
		l__PhysicsService__15:SetPartCollisionGroup(v32, "Players");
		local v33 = Instance.new("BodyForce");
		v33.Force = Vector3.new(0, v32:GetMass() * l__Workspace__10.Gravity / 1.3, 0);
		v33.Parent = v32;
		local v34 = Instance.new("BillboardGui");
		v34.Size = UDim2.new(v29, 0, v29, 0);
		v34.LightInfluence = 0;
		local v35 = Instance.new("ImageLabel");
		local v36 = p18;
		if v36 ~= nil then
			v36 = v36.color;
		end;
		if v36 then
			v35.Image = "rbxassetid://5607858133";
			v35.ImageColor3 = v36;
		else
			v35.Image = v31;
			v35.ScaleType = Enum.ScaleType.Tile;
			v35.TileSize = UDim2.new(50, 0, 50, 0);
		end;
		local v37 = p18;
		if v37 ~= nil then
			v37 = v37.transparency;
		end;
		if v37 ~= nil then
			v35.Transparency = p18.transparency;
		end;
		v35.Size = UDim2.new(0, 0, 0, 0);
		v35.Position = UDim2.new(0.5, 0, 0.5, 0);
		v35.AnchorPoint = Vector2.new(0.5, 0.5);
		v35.BorderSizePixel = 0;
		v35.BackgroundTransparency = 1;
		v35.Parent = v34;
		l__TweenService__6:Create(v35, TweenInfo.new(0.1), {
			Size = UDim2.new(1, 0, 1, 0)
		}):Play();
		v34.Parent = v32;
		local v38 = Instance.new("BoolValue");
		v38.Name = "Targettable";
		v38.Value = false;
		v38.Parent = v32;
		v32.Parent = l__Workspace__10;
		v1.Promise.delay(0.78 + math.random() * 0.15):andThen(function()
			l__TweenService__6:Create(v35, TweenInfo.new(0.1), {
				Size = UDim2.new(0, 0, 0, 0)
			}):Play();
		end);
		l__Debris__16:AddItem(v32, 1);	
	end;
end;
l__Reflect__2.defineMetadata(v4, "identifier", "@easy-games/game-core:client/controllers/game-release/prophunt-game-release-controller@ProphuntGameReleaseController");
l__Reflect__2.defineMetadata(v4, "flamework:isExternal", false);
l__Reflect__2.defineMetadata(v4, "flamework:dependencies", { "@easy-games/game-core:client/controllers/notification-controller@NotificationController" });
l__Reflect__2.defineMetadata(v4, "flamework:implements", { "$:flamework@OnStart" });
l__Reflect__2.defineMetadata(v4, "flamework:decorators", { "$:flamework@Controller" });
l__Reflect__2.defineMetadata(v4, "flamework:decorators.$:flamework@Controller", {
	type = "Controller"
});
return {
	ProphuntGameReleaseController = v4
};
