--[[VARIABLE DEFINITION ANOMALY DETECTED, DECOMPILATION OUTPUT POTENTIALLY INCORRECT]]--
-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, v1.getModule(script, "@rbxts", "services"));
local v3 = setmetatable({}, {
	__tostring = function()
		return "SoundManager";
	end
});
v3.__index = v3;
function v3.new(...)
	local v4 = setmetatable({}, v3);
	return v4:constructor(...) and v4;
end;
function v3.constructor(p1)

end;
function v3.registerSound(p2, p3, p4)
	if p4 == nil then
		p4 = {};
	end;
	local v5 = p4;
	if v5 ~= nil then
		v5 = v5.preload;
	end;
	local v6 = v5;
	if v6 == nil then
		v6 = true;
	end;
	p2.soundConfigs[p3] = p4;
	if v6 then
		table.insert(p2.preloadEntries, {
			assetId = p3, 
			config = p4
		});
	end;
end;
function v3.bulkRegisterSounds(p5, p6)
	for v7, v8 in ipairs(p6) do
		if p5.soundConfigs[v8] == nil then
			p5:registerSound(v8);
		end;
	end;
end;
local u1 = v1.import(script, v1.getModule(script, "@rbxts", "make"));
function v3.createSound(p7, p8)
	local v9 = p7.soundConfigs[p8] or {};
	local v10 = nil;
	if v9.playbackSpeed then
		v10 = v9.playbackSpeed.Min + math.random() * (v9.playbackSpeed.Max - v9.playbackSpeed.Min);
	end;
	local v11 = {
		Name = tostring(p8), 
		SoundId = p8
	};
	local v12 = v9.volume;
	if v12 == nil then
		v12 = 0.5;
	end;
	v11.Volume = v12;
	v11.PlaybackSpeed = v10;
	local v13 = v9.rollOffMaxDistance;
	if v13 == 0 or v13 ~= v13 or not v13 then
		v13 = 60;
	end;
	v11.RollOffMaxDistance = v13;
	v11.RollOffMinDistance = v9.rollOffMinDistance;
	return u1("Sound", v11);
end;
local u2 = v1.import(script, v1.getModule(script, "@rbxts", "object-utils"));
local l__ContentProvider__3 = v2.ContentProvider;
function v3.preload(p9)
	local v14 = {};
	local v15 = 0;
	local v16, v17, v18 = ipairs((u2.values(p9.preloadEntries)));
	while true do
		local v19, v20 = v16(v17, v18);
		if not v19 then
			break;
		end;
		if v20.config.preload ~= false == true then
			v15 = v15 + 1;
			v14[v15] = v20;
		end;	
	end;
	table.sort(v14, function(p10, p11)
		local v21 = p10.config.preloadPriority;
		if v21 == nil then
			v21 = 10;
		end;
		local v22 = p11.config.preloadPriority;
		if v22 == nil then
			v22 = 10;
		end;
		return v21 < v22;
	end);
	local v23 = {};
	local v24 = 0;
	for v25, v26 in ipairs(v14) do
		local v27 = p9:createSound(v26.assetId);
		if v27 ~= nil then
			v24 = v24 + 1;
			v23[v24] = v27;
		end;
	end;
	l__ContentProvider__3:PreloadAsync(v23);
end;
local l__GameQueryUtil__4 = v1.import(script, script.Parent.Parent, "game-world-query", "game-query-util").GameQueryUtil;
function v3.playSound(p12, p13, p14)
	if typeof(p13) == "Instance" then
		local v28 = p13;
	else
		local v29 = p12.soundConfigs[p13];
		if v29 then
			local v30 = {};
			for v31, v32 in pairs(v29) do
				v30[v31] = v32;
			end;
			if type(p14) == "table" then
				for v33, v34 in pairs(p14) do
					v30[v33] = v34;
				end;
			end;
			p14 = v30;
		end;
		v28 = p12:createSound(p13);
	end;
	if not v28 then
		return nil;
	end;
	local v35 = p14;
	if v35 ~= nil then
		v35 = v35.looped;
	end;
	if v35 ~= nil then
		v28.Looped = p14.looped;
	end;
	local v36 = p14;
	if v36 ~= nil then
		v36 = v36.volumeMultiplier;
	end;
	if v36 ~= nil then
		v28.Volume = v28.Volume * p14.volumeMultiplier;
	end;
	local v37 = p14;
	if v37 ~= nil then
		v37 = v37.playbackSpeedMultiplier;
	end;
	if v37 ~= nil then
		v28.PlaybackSpeed = v28.PlaybackSpeed * p14.playbackSpeedMultiplier;
	end;
	local v38 = p14;
	if v38 ~= nil then
		v38 = v38.rollOffMaxDistance;
	end;
	if v38 ~= nil then
		v28.RollOffMaxDistance = p14.rollOffMaxDistance;
	end;
	local v39 = p14;
	if v39 ~= nil then
		v39 = v39.rollOffMinDistsance;
	end;
	if v39 ~= nil then
		v28.RollOffMinDistance = p14.rollOffMinDistsance;
	end;
	local v40 = p14;
	if v40 ~= nil then
		v40 = v40.fadeInTime;
	end;
	if v40 ~= 0 and v40 == v40 and v40 then
		v28.Volume = 0;
		p12:tweenSoundVolume(v28, v28.Volume, p14.fadeInTime);
	end;
	local v41 = p14;
	if v41 ~= nil then
		v41 = v41.fadeOutTime;
	end;
	if v41 ~= 0 and v41 == v41 and v41 then
		task.spawn(function()
			if not v28 then
				return nil;
			end;
			if not v28.IsLoaded then
				v28.Loaded:Wait();
			end;
			local l__TimeLength__42 = v28.TimeLength;
			while true do
				local v43 = task.wait(0.5);
				if v43 == 0 then
					break;
				end;
				if v43 ~= v43 then
					break;
				end;
				if not v43 then
					break;
				end;
				local v44 = v28;
				if v44 ~= nil then
					v44 = v44.IsPlaying;
				end;
				if not v44 then
					break;
				end;
				local v45 = (l__TimeLength__42 - v28.TimePosition) / v28.PlaybackSpeed;
				if v45 <= p14.fadeOutTime then
					p12:tweenSoundVolume(v28, 0, v45);
					return;
				end;			
			end;
		end);
	end;
	local v46 = p14;
	if v46 ~= nil then
		v46 = v46.position;
	end;
	if v46 then
		local v47 = p14;
		if v47 ~= nil then
			v47 = v47.parent;
		end;
		local v48 = v47;
		local v49 = false;
		if not v48 then
			v49 = true;
			local v50 = {
				Size = Vector3.new(1, 1, 1)
			};
			local v51 = p14;
			if v51 ~= nil then
				v51 = v51.position;
			end;
			v50.CFrame = CFrame.new(v51);
			v50.Anchored = true;
			v50.CanCollide = false;
			v50.CanQuery = false;
			v50.Transparency = 1;
			v50.Parent = p12.workspaceSoundsFolder;
			v48 = u1("Part", v50);
			l__GameQueryUtil__4:setQueryIgnored(v48);
		end;
		v28.Parent = v48;
		v28.Ended:Connect(function()
			local v52 = nil;
			wait(3);
			if v49 then
				v52 = v48;
				if v52 == nil then
					return;
				end;
			else
				if v28 ~= nil then
					v28:Destroy();
				end;
				return;
			end;
			v52:Destroy();
		end);
	else
		v28.Parent = p12.localSoundsFolder;
		v28.Ended:Connect(function()
			if v28 ~= nil then
				v28:Destroy();
			end;
		end);
	end;
	v28:Play();
	return v28;
end;
local l__TweenService__5 = v2.TweenService;
function v3.tweenSoundVolume(p15, p16, p17, p18, p19)
	local v53 = p19;
	if v53 ~= nil then
		v53 = v53.easingStyle;
	end;
	local v54 = v53;
	if v54 == nil then
		v54 = Enum.EasingStyle.Linear;
	end;
	local v55 = p19;
	if v55 ~= nil then
		v55 = v55.easingDirection;
	end;
	local v56 = v55;
	if v56 == nil then
		v56 = Enum.EasingDirection.In;
	end;
	local v57 = l__TweenService__5:Create(p16, TweenInfo.new(p18, v54, v56), {
		Volume = p17
	});
	v57:Play();
	return v57;
end;
v3.preloadEntries = {};
v3.soundConfigs = {};
v3.workspaceSoundsFolder = u1("Folder", {
	Name = "GameSounds", 
	Parent = v2.Workspace
});
v3.localSoundsFolder = u1("Folder", {
	Name = "GameSounds", 
	Parent = v2.Lighting
});
return {
	SoundManager = v3
};
