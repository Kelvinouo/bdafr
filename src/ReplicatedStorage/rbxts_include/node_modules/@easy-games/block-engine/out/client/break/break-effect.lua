
-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, v1.getModule(script, "@easy-games", "game-core").out);
local v3 = v1.import(script, v1.getModule(script, "@rbxts", "services"));
local v4 = setmetatable({}, {
	__tostring = function()
		return "BreakEffect";
	end
});
v4.__index = v4;
function v4.new(...)
	local v5 = setmetatable({}, v4);
	return v5:constructor(...) and v5;
end;
function v4.constructor(p1)

end;
local l__Players__1 = v3.Players;
local l__BlockEngine__2 = v1.import(script, script.Parent.Parent.Parent).BlockEngine;
local l__RandomUtil__3 = v2.RandomUtil;
local l__SoundManager__4 = v2.SoundManager;
function v4.playHit(p2, p3, p4, p5)
	if l__Players__1.LocalPlayer.Character and l__Players__1.LocalPlayer:DistanceFromCharacter(l__BlockEngine__2:getWorldPosition(p4)) < 100 then
		local v6 = l__BlockEngine__2:getHandlerRegistry():getHandler(p3);
		if v6 ~= nil then
			v6 = v6:getBlockMeta();
		end;
		if v6 and v6.breakSound ~= nil then
			local v7 = {};
			if l__Players__1.LocalPlayer == p5 then
				local v8 = nil;
			else
				v8 = l__BlockEngine__2:getWorldPosition(p4);
			end;
			v7.position = v8;
			l__SoundManager__4:playSound(l__RandomUtil__3.fromList(unpack(v6.breakSound())), v7);
		end;
		v4:spawnPixelParticle(p3, p4, {
			amount = math.random(3, 5)
		});
	end;
end;
function v4.playBreak(p6, p7, p8, p9)
	p6:playHit(p7, p8, p9);
end;
local l__PhysicsService__5 = v3.PhysicsService;
local l__GameQueryUtil__6 = v2.GameQueryUtil;
local l__Workspace__7 = v3.Workspace;
local l__TweenService__8 = v3.TweenService;
local l__Debris__9 = v3.Debris;
function v4.spawnPixelParticle(p10, p11, p12, p13)
	local v9 = 0;
	local v10 = false;
	while true do
		if v10 then
			v9 = v9 + 1;
		else
			v10 = true;
		end;
		local v11 = p13;
		if v11 ~= nil then
			v11 = v11.amount;
		end;
		local v12 = v11;
		if v12 == nil then
			v12 = 1;
		end;
		if not (v9 < v12) then
			break;
		end;
		local v13 = Vector3.new(math.random(-100, 100) / 100 * 5, math.random(50, 100) / 100 * 16, math.random(-100, 100) / 100 * 5) * 0.75;
		local v14 = 0.18 * math.random(80, 150) / 100;
		local v15 = Instance.new("Part");
		v15.Size = Vector3.new(v14, v14, v14);
		v15.CFrame = CFrame.new(l__BlockEngine__2:getWorldPosition(p12));
		v15.Velocity = v13;
		v15.Transparency = 0;
		v15.CanCollide = false;
		v1.Promise.defer(function()
			wait(0.05);
			v15.CanCollide = true;
		end);
		l__PhysicsService__5:SetPartCollisionGroup(v15, "BlockParticles");
		l__GameQueryUtil__6:setQueryIgnored(v15);
		local v16 = Instance.new("BodyForce");
		v16.Force = Vector3.new(0, v15:GetMass() * l__Workspace__7.Gravity / 1.3, 0);
		v16.Parent = v15;
		local v17 = Instance.new("BoolValue");
		v17.Name = "Targettable";
		v17.Value = false;
		v17.Parent = v15;
		v15.Parent = l__Workspace__7;
		v1.Promise.delay(0.78 + math.random() * 0.15):andThen(function()
			l__TweenService__8:Create(v15, TweenInfo.new(0.18), {
				Size = Vector3.new(0, 0, 0), 
				Transparency = 1
			}):Play();
		end);
		l__Debris__9:AddItem(v15, 1.3);	
	end;
end;
return {
	BreakEffect = v4
};

