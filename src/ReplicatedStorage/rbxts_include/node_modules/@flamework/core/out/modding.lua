-- Decompiled with the Synapse X Luau decompiler.

local v1 = _G[script];
local v2 = v1.import(script, v1.getModule(script, "@rbxts", "signal"));
local v3 = {};
local l__Reflect__1 = v1.import(script, script.Parent, "reflect").Reflect;
local u2 = {};
local u3 = {};
local u4 = {};
local u5 = {};
local u6 = v2.new();
local function v4(p1)
	local v5 = {
		eventIds = {}, 
		involvement = {}
	};
	for v6, v7 in ipairs(l__Reflect__1.getMetadatas(p1, "flamework:implements")) do
		for v8, v9 in ipairs(v7) do
			if v5.eventIds[v9] == nil then
				local v10 = u2[v9];
				if not v10 then
					v10 = {};
					u2[v9] = v10;
				end;
				v10[p1] = true;
				v5.eventIds[v9] = true;
				table.insert(v5.involvement, v10);
				local v11 = u3[v9];
				if v11 ~= nil then
					v11:Fire(p1);
				end;
			end;
		end;
	end;
	local v12 = l__Reflect__1.getMetadata(p1, "flamework:decorators");
	if v12 then
		for v13, v14 in ipairs(v12) do
			if v5.eventIds[v14] == nil then
				local v15 = u4[v14];
				if not v15 then
					v15 = {};
					u4[v14] = v15;
				end;
				v15[p1] = true;
				v5.eventIds[v14] = true;
				table.insert(v5.involvement, v15);
				local v16 = u3[v14];
				if v16 ~= nil then
					v16:Fire(p1);
				end;
			end;
		end;
	end;
	u5[p1] = v5;
	u6:Fire(p1);
end;
v3.addListener = v4;
local u7 = {};
local u8 = v2.new();
function v3.removeListener(p2)
	local v17 = u5[p2];
	if not v17 then
		return nil;
	end;
	for v18, v19 in ipairs(v17.involvement) do
		v19[p2] = nil;
	end;
	for v20, v21 in pairs(v17.eventIds) do
		local v22 = u7[v20];
		if v22 ~= nil then
			v22:Fire(p2);
		end;
	end;
	u5[p2] = nil;
	u8:Fire(p2);
end;
function v3.onListenerAdded(p3, p4)
	if p4 == nil then
		for v23, v24 in pairs(u5) do
			task.spawn(p3, v23);
		end;
		return u6:Connect(p3);
	end;
	local v25 = u3[p4];
	if not v25 then
		v25 = v2.new();
		u3[p4] = v25;
	end;
	local v26 = u2[p4] or u4[p4];
	if v26 then
		for v27, v28 in pairs(v26) do
			task.spawn(p3, v27);
		end;
	end;
	return v25:Connect(p3);
end;
function v3.onListenerRemoved(p5, p6)
	if p6 == nil then
		return u8:Connect(p5);
	end;
	local v29 = u7[p6];
	if not v29 then
		v29 = v2.new();
		u7[p6] = v29;
	end;
	return v29:Connect(p5);
end;
local u9 = nil;
function v3.createDecorator(p7, p8)
	local v30 = {};
	function v30.func(p9, p10)
		u9(p9, p10);
		p8(p9, p10);
	end;
	return v30;
end;
function v3.createMetaDecorator(p11)
	return {
		func = function(p12, p13)
			u9(p12, p13);
		end
	};
end;
function v3.getDecorators(p14)
	assert(p14 ~= nil);
	local v31 = l__Reflect__1.decorators[p14];
	if not v31 then
		return {};
	end;
	local function v32(p15)
		local v33 = l__Reflect__1.getOwnMetadata(p15, "flamework:decorators." .. p14);
		assert(v33);
		return {
			object = p15, 
			arguments = v33.arguments
		};
	end;
	local v34 = table.create(#v31);
	for v35, v36 in ipairs(v31) do
		v34[v35] = v32(v36, v35 - 1, v31);
	end;
	return v34;
end;
local u10 = nil;
function v3.getPropertyDecorators(p16, p17)
	local v37 = {};
	assert(p17 ~= nil);
	for v38, v39 in ipairs(l__Reflect__1.getProperties(p16)) do
		local v40 = u10(p16, v39, p17);
		if v40 then
			v37[v39] = v40;
		end;
	end;
	return v37;
end;
u10 = function(p18, p19, p20)
	local v41 = l__Reflect__1.getMetadata(p18, "flamework:decorators." .. tostring(p20), p19);
	if v41 then
		return v41;
	end;
	return nil;
end;
v3.getDecorator = u10;
local u11 = {};
local u12 = {};
local u13 = nil;
local function v42(p21)
	local v43 = u11[p21];
	if v43 ~= nil then
		return v43;
	end;
	if table.find(u12, p21) ~= nil then
		local v44 = table.create(#u12);
		for v45, v46 in ipairs(u12) do
			v44[v45] = tostring(v46);
		end;
		error("Circular dependency detected " .. table.concat(v44, " <=> ") .. " <=> " .. tostring(p21));
	end;
	table.insert(u12, p21);
	local v47 = u13(p21, (l__Reflect__1.getOwnMetadata(p21, "flamework:dependency_resolution")));
	u11[p21] = v47;
	u12[#u12] = nil;
	v4(v47);
	return v47;
end;
v3.resolveSingleton = v42;
function v3.getSingletons()
	return u11;
end;
local u14 = {};
function v3.registerDependency(p22, p23)
	assert(p23 ~= nil);
	if type(p22) == "function" then
		u14[p23] = p22;
		return;
	end;
	u14[p23] = function()
		return p22;
	end;
end;
local u15 = nil;
u13 = function(p24, p25)
	if p25 == nil then
		p25 = {};
	end;
	local v48 = u15(p24, p25);
	v48[2]();
	return v48[1];
end;
v3.createDependency = u13;
local u16 = nil;
local u17 = nil;
u15 = function(p26, p27)
	if p27 == nil then
		p27 = {};
	end;
	local v49 = u16(p26);
	local v50 = {};
	local u18 = v49[2];
	v50[1] = v49[1];
	v50[2] = function()
		local v51 = l__Reflect__1.getMetadata(p26, "flamework:parameters");
		local v52 = {};
		if v51 then
			for v53, v54 in pairs(v51) do
				v52[v53 - 1 + 1] = u17(p26, v54, v53 - 1, p27);
			end;
		end;
		u18(unpack(v52));
	end;
	return v50;
end;
v3.createDeferredDependency = u15;
local u19 = nil;
u17 = function(p28, p29, p30, p31)
	if p31.handle ~= nil then
		local v55 = p31.handle(p29, p30);
		if v55 ~= nil then
			return v55;
		end;
	end;
	local v56 = u14[p29];
	if v56 ~= nil then
		return v56(p28);
	end;
	if string.sub(p29, 1, 2) == "$p" then
		if string.sub(p29, 1, 3) == "$ps" then
			return string.sub(p29, 5);
		end;
		if string.sub(p29, 1, 3) == "$pn" then
			local v57 = tonumber(string.sub(p29, 5));
			if v57 == nil then
				v57 = 0;
			end;
			return v57;
		end;
		if p31.handlePrimitive ~= nil then
			return p31.handlePrimitive(p29, p30);
		end;
		error("Unexpected primitive dependency '" .. p29 .. "' while constructing " .. tostring(p28));
	end;
	local v58 = l__Reflect__1.idToObj[p29];
	if not v58 or not u19(v58) then
		error("Could not find constructor for " .. p29 .. " while constructing " .. tostring(p28));
	end;
	return v42(v58);
end;
function v3.macro(p32, p33)
	if type(p32) == "string" then
		return {
			[p32] = p33
		};
	end;
	local v59 = {};
	for v60, v61 in ipairs(p32) do
		v59[v61[1]] = v61[2];
	end;
	return v59;
end;
u9 = function(p34, p35)
	if p34.isStatic then
		local v62 = "static:" .. p34.property;
	else
		v62 = p34.property;
	end;
	l__Reflect__1.defineMetadata(p34.object, "flamework:decorators." .. p34.id, {
		arguments = p35
	}, v62);
	local v63 = l__Reflect__1.getMetadata(p34.object, "flamework:decorators", v62);
	if not v63 then
		v63 = {};
		l__Reflect__1.defineMetadata(p34.object, "flamework:decorators", v63, v62);
	end;
	table.insert(v63, p34.id);
end;
u19 = function(p36)
	local v64 = false;
	if p36.new ~= nil then
		v64 = p36.constructor ~= nil;
	end;
	return v64;
end;
u16 = function(p37)
	local v65 = setmetatable({}, p37);
	local v66 = {};
	v66[1] = v65;
	v66[2] = function(...)
		local v67 = v65:constructor(unpack({ ... }));
		local v68 = true;
		if v67 ~= nil then
			v68 = v67 == v65;
		end;
		assert(v68, "Deferred constructors are not allowed to return values.");
	end;
	return v66;
end;
return {
	Modding = v3
};
